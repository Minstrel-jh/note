[linux]: /note/linux/README.md
[url:vbird_variable_rule]: http://cn.linux.vbird.org/linux_basic/0320bash.php#variable_rule

# 变量

[返回][linux]

## 定义与使用

```bash
// 定义
variable=value

// 使用
$variable
${variable}
```

### 变量的高级用法

- 变量内容的删除与取代

| 模式                       | 说明                                                           |
| -------------------------- | -------------------------------------------------------------- |
| ${变量#关键词}             | 若变量内容从头开始的数据符合**关键词**，则将符合的最短数据删除 |
| ${变量##关键词}            | 若变量内容从头开始的数据符合**关键词**，则将符合的最长数据删除 |
| ${变量%关键词}             | 若变量内容从尾向前的数据符合**关键词**，则将符合的最短数据删除 |
| ${变量%%关键词}            | 若变量内容从尾向前的数据符合**关键词**，则将符合的最长数据删除 |
| ${变量/旧字符串/新字符串}  | 若变量内容符合**旧字符串**则**第一个旧字符串会被新字符串取代** |
| ${变量//旧字符串/新字符串} | 若变量内容符合**旧字符串**则**全部的旧字符串会被新字符串取代** |

- 变量的测试与内容替换

| 模式         | 说明                                                        |
| ------------ | ----------------------------------------------------------- |
| ${str-expr}  | 若str**没定义**，则返回expr                                 |
| ${str:-expr} | 若str**没定义或为空字符串**，则返回expr                     |
| ${str=expr}  | 若str**没定义**，则返回expr，同时设置str=expr               |
| ${str:=expr} | 若str**没定义或为空字符串**，则返回expr，同时设置str=expr   |
| ${str+expr}  | 若str**已定义**，则返回expr                                 |
| ${str:+expr} | 若str**已定义且为空字符串**，则返回expr                     |
| ${str?expr}  | 若str**没定义**，则将expr输出到stderr，终止脚本             |
| ${str:?expr} | 若str**没定义或为空字符串**，则将expr输出到stderr，终止脚本 |

## 变量配置守则

> 摘自 [《鸟哥的Linux私房菜 基础篇》 第十一章 2.3][url:vbird_variable_rule]

1. 变量与变量内容以一个等号`=`来连结
2. 等号两边不能直接接空格符
3. 变量名称只能是英文字母与数字，但是开头字符不能是数字
4. 变量内容若有空格符可使用双引号`"`或单引号`'`将变量内容结合起来
   - `""`双引号内的特殊字符如`$`和``` `` ```，可以保有原本的特性
   - `''`单引号内的特殊字符则仅为一般字符 (纯文本)
5. 可用跳脱字符`\`将特殊符号(如换行符, `$`, `\`, 空格符, `'`等)变成一般字符
6. 在一串命令中，还需要藉由其他的命令提供的信息，可以使用反单引号`` `命令` ``或`$(命令)`
7. 若该变量为扩增变量内容时，则可用`"$变量名称"`或`${变量}`累加内容

   ```bash
   PATH="$PATH":/home/bin
   ```

8. 若该变量需要在其他子程序运行，则需要以`export`来使变量变成环境变量
9. 通常大写字符为系统默认变量，自行配置变量可以使用小写字符
10. 取消变量的方法为使用`unset`

## 环境变量

- `env`: 观察环境变量
  - HOME
  - SHELL
  - HISTSIZE
  - PATH
  - LANG
  - RANDOM
- `set`: 观察所有变量(环境变量与自定义变量)
  - PS1
  - $
  - ?
  - OSTYPE, HOSTTYPE, MACHTYPE
- `export`: 自定义变量转成环境变量
  
  环境变量与自定义变量的区别：**该变量是否会被子程序所继续引用**
